{
  "name": "PicTime Dev Container",
  "build": {
    "dockerfile": "Dockerfile",
    "args": {
      "BUILDKIT_PROGRESS": "plain"
    }
  },
  "features": {
    "ghcr.io/devcontainers/features/docker-in-docker:2": {
      "version": "latest",
      "enableNonRootDocker": "true"
    }
  },
  "workspaceFolder": "/workspaces/PicTime_app",
  "shutdownAction": "none",
  "settings": {
    "terminal.integrated.defaultProfile.linux": "bash"
  },
  "onCreateCommand": "echo 'Ensure Codespaces secrets MSSQL_SA_PASSWORD and PCT901S_USER_PASSWORD are set'",
  "extensions": [
    "vscjava.vscode-java-pack",
    "redhat.vscode-yaml",
    "ms-azuretools.vscode-docker",
    "vscjava.vscode-spring-boot-dashboard",
    "mhutchie.git-graph"
  ],
  "initializeCommand": "echo 'Checking environment...' && ( [ -n \"${MSSQL_SA_PASSWORD-}\" ] || echo 'WARNING: MSSQL_SA_PASSWORD not set' ) && ( [ -n \"${PCT901S_USER_PASSWORD-}\" ] || echo 'WARNING: PCT901S_USER_PASSWORD not set' )",
  "postCreateCommand": "cd /workspaces/PicTime_app && chmod +x .devcontainer/*.sh && .devcontainer/check-secrets.sh && .devcontainer/ensure-docker.sh && .devcontainer/start-mssql.sh && .devcontainer/init-db.sh",
  "remoteUser": "vscode",
  "forwardPorts": [1433],
  "portsAttributes": {
    "1433": {
      "label": "MSSQL",
      "onAutoForward": "openBrowser"
    }
  },
  "secrets": [
    {
      "id": "MSSQL_SA_PASSWORD",
      "name": "MSSQL_SA_PASSWORD",
      "description": "SA password for local MSSQL server (set in Codespaces secrets)"
    },
    {
      "id": "PCT901S_USER_PASSWORD",
      "name": "PCT901S_USER_PASSWORD",
      "description": "Password for pct901s_user created by init SQL script (set in Codespaces secrets)"
    }
  ],
  "containerEnv": {
    "MSSQL_SA_PASSWORD": "${secrets:MSSQL_SA_PASSWORD}",
    "PCT901S_USER_PASSWORD": "${secrets:PCT901S_USER_PASSWORD}"
  }
}